- hosts: target
  become: yes
  tasks:
    - name: Load backend image
      shell: docker load -i /tmp/backend.tar

    - name: Stop old backend
      shell: docker stop backend || true && docker rm backend || true

    - name: Run backend container
      shell: docker run -d --name backend -p 5000:5000 backend:latest

    - name: Load frontend image
      shell: docker load -i /tmp/frontend.tar

    - name: Stop old frontend
      shell: docker stop frontend || true && docker rm frontend || true

    - name: Run frontend container
      shell: docker run -d --name frontend -p 80:80 frontend:latest
